{% if not single %}{% if failures_only %}
<a class="button" href="{{commits_url}}"><span>All</span></a>
{% if failures_only == "0" %}
<a class="button" href="{{commits_url}}?failures_only=1"><span>Hide Non-Failures</span></a>
{% else %}
<a class="button" href="{{commits_url}}?failures_only=0"><span>Hide Failures</span></a>
{% end %}
{% else %}
<a class="button" href="{{commits_url}}?failures_only=1"><span>Hide Non-Failures</span></a>
<a class="button" href="{{commits_url}}?failures_only=0"><span>Hide Failures</span></a>
{% end %}{% end %}
{% if single %}
<h1><a href="/commits">Commits</a> &middot; {{ escape(version[:12]) }}</h1>
{% elif repo %}
<h1><a href="/commits">Commits</a> &middot; {{ escape(repo) }}</h1>
{% else %}
<h1>Commits</h1>
{% end %}

{% if commits %}
<blockquote><table cellspacing="0px" width="100%">
<tr class="header-small">
	<td></td>
	{% for platform in platforms %}
	<td>{{escape(platform.rsplit(' ', 1)[0])}}<br />{{escape(platform.rsplit(' ', 1)[1])}}</td>
	{% end %}
</tr>
{% for commit in commits %}
<tr class="middle">
	<td class="left-pad-none">
		<div class="text">
			{{escape(commit.subject or '')}}
		</div>
		<div class="small-info">
			<img class="gravatar" src="http://www.gravatar.com/avatar/{% if commit.user in gravatars %}{{gravatars[commit.user]}}{% else %}{{ md5(commit.author_email).hexdigest() }}{% end %}?s=16&amp;d=http%3A%2F%2Fgithub.com%2Fimages%2Fgravatars%2Fgravatar-16.png" />
		{% if commit.user %}<a href="/activity/*/{{escape(commit.user)}}">{{escape(commit.user)}}</a>{% else %}{{escape(commit.author_email or commit.author or '')}}{% end %}
		/
		<a href="/activity/{{escape(url_escape(commit.repo))}}">{{escape(commit.repo)}}</a>
		/
		{% if single %}
		<code>{{escape(version[:12])}}</code>
		&nbsp;&middot;&nbsp;
		<a href="http://github.com/{{'%s/%s' % repos[commit.repo]}}/commit/{{version}}">github</a>
		{% else %}
		<a href="/commit/{{commit.repo}}/{{revision = escape(url_escape(commit.key().name().split(':')[1]))}}"><code>{{revision[:12]}}</code></a>
		&nbsp;&middot;&nbsp;
		<a href="http://github.com/{{'%s/%s' % repos[commit.repo]}}/commit/{{revision}}">github</a>
		{% end %}
		</div>
	</td>
	{% for platform in platforms %}{% if platform in commit.passed_builds %}
	<td><a class="no-link" href="/builds/{{escape(url_escape(commit.repo))}}/{{escape(url_escape(platform))}}/{{escape(commit.version)}}">✓</a></td>
	{% elif platform in commit.failed_builds %}
	<td><a class="fail" href="/builds/{{escape(url_escape(commit.repo))}}/{{escape(url_escape(platform))}}/{{escape(commit.version)}}">fail</a></td>
	{% else %}
	<td>-</td>
	{% end %}{% end %}
</tr>
{% end %}
</table></blockquote>
{% if more %}
<a class="button" href="{{commits_url}}?next={{more}}&amp;{% if failures_only %}failures_only={{failures_only}}{% end %}"><span>Next &rarr;</span></a>
{% end %}
{% end %}

{% if builds %}
<h2>Builds</h2>
<blockquote><table cellspacing="0px" width="100%">
<tr class="header">
	<td>ID</td>
	<td>Platform</td>
	<td>Status</td>
	<td>When</td>
	<td>By</td>
</tr>
{% for build in builds %}
<tr>
	<td><a href="/build/{{build_id = build.key().id()}}">{{build_id}}</a></td>
	<td>{{escape(build.build_platform.lower())}}</td>
	<td>
		<table class="build-results" cellspacing="0px"><tr>
			{% if build.build_phases %}
			{% for phase, failure in decode_json(build.build_phases) %}
			<td class="{% if failure %}fail">✗ {% else %}pass">✓ {% end %}&nbsp;{{ escape(phase) }}</td>
			<td> </td>
			{% end %}
			{% else %}
			<td class="fail">✗ &nbsp;git-slave failure</td>
			{% end %}
		</tr></table>
	</td>
	<td><span class="timestamp">{{ build.d.strftime('%s') }}</span></td>
	<td><a href="/slave/{{build.slave}}">slave {{ build.slave }}</td>
</tr>
{% end %}
</table></blockquote>
{% end %}

{% if (not single) and len(repos) > 1 %}
<h2>{% if repo %}Other{% else %}Specific{% end %} Repositories</h2>
<ul>
{% for repo_name in sorted(repos) %}{% if repo_name != repo %}
<li><a href="/commits/{{escape(repo_name)}}">{{repo_name}}</a></li>
{% end %}{% end %}
</ul>
{% end %}